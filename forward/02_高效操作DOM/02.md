# 高效操作DOM

## 为什么DOM操作耗时

- 线程切换
  + 浏览器为了避免两个引擎同时修改页面造成渲染结果不一致，增加了两个引擎互斥的机制，某一个引擎在执行时，另一个引擎会被阻塞。操作系统在进行线程切换的时候需要保存上一个线程的状态信息，俗称上下文切换，而这个操作比较耗时。
- 重新渲染
  + 另一个更耗时的因素上元素及样式变化引起的再次渲染，在重新渲染的时候最耗时的步骤为重排和重绘
    - 引起重排：比如 
      * 修改元素边距、大小
      * 添加删除元素
      * 改变窗口大小
    - 引起重绘：比如
      * 设置背景图片
      * 修改字体颜色
      * 改变 visibility 属性值  

## 如何高效操作DOM

- 在操作外操作元素

- 批量操作元素

- 缓存元素集合

